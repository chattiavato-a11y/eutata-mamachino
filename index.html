<!doctype html>
<html lang="en" data-theme="dark">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Chat ¬∑ Local-first with WebGPU fallback</title>
<link rel="stylesheet" href="styles.css" />
<style>
  :root{ --bg:#0b0c10; --card:#121319; --ink:#e6e6e6; --muted:#a9b0b8; --accent:#6ad1ff; --ring:rgba(106,209,255,.35); }
  [data-theme="light"]{ --bg:#ffffff; --card:#f5f7fb; --ink:#1f2430; --muted:#536070; --accent:#0077ff; --ring:rgba(0,119,255,.25); }
  body{margin:0;background:var(--bg);color:var(--ink);font:14px/1.5 system-ui,Segoe UI,Roboto,Helvetica,Arial;}
  .wrap{max-width:900px;margin:0 auto;padding:20px}
  header{display:flex;gap:10px;align-items:center;justify-content:space-between;margin-bottom:10px;flex-wrap:wrap}
  .toggles{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  button,select{background:var(--card);color:var(--ink);border:1px solid #242634;border-radius:10px;padding:8px 12px}
  button:hover{outline:2px solid var(--ring)}
  .session-meters{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:8px}
  .session-meter{display:inline-flex;align-items:center;gap:8px;padding:6px 12px;border-radius:999px;border:1px solid #242634;background:var(--card);font-size:12px}
  .session-meter progress{width:120px;height:6px;border-radius:999px;overflow:hidden;background:rgba(255,255,255,.08)}
  .session-meter progress::-webkit-progress-bar{background:rgba(255,255,255,.08);border-radius:999px}
  .session-meter progress::-webkit-progress-value{background:var(--accent);border-radius:999px}
  .session-meter progress::-moz-progress-bar{background:var(--accent);border-radius:999px}
  .session-meter-value{font-variant-numeric:tabular-nums;color:var(--ink)}
  .chat{background:var(--card);border:1px solid #242634;border-radius:14px;padding:14px;height:60vh;overflow:auto}
  .msg{margin:8px 0;padding:10px 12px;border-radius:10px;white-space:pre-wrap}
  .me{background:rgba(106,209,255,.08);border:1px solid rgba(106,209,255,.25)}
  .ai{background:rgba(255,255,255,.03);border:1px solid #2a2d3b}
  .bar{display:flex;gap:8px;margin-top:10px}
  .bar textarea{flex:1;min-height:44px;max-height:160px;resize:vertical;background:var(--card);color:var(--ink);border:1px solid #242634;border-radius:10px;padding:10px}
  .muted{color:var(--muted);font-size:12px}
  .bad{color:#ff7b7b}
</style>

<body>
  <div class="wrap">
    <header>
      <div>
        <h1 data-i18n="headerTitle">OPS Chat Interface</h1>
      </div>
      <div class="toggles" role="group" aria-label="Display and language settings">
        <label for="themeBtn" class="muted" data-i18n="themeLabel">Theme</label>
        <button id="themeBtn" type="button" aria-pressed="true">Dark</button>
        <label for="langSel" class="muted" data-i18n="langLabel">Language</label>
        <select id="langSel" aria-label="Language selector">
          <option value="en" selected>English</option>
          <option value="es">Espa√±ol</option>
        </select>
      </div>
    </header>

    <main>
      <section aria-labelledby="chat-title">
        <div class="policy-card">
          <h2 id="chat-title">Session Console</h2>
          <form id="chatForm" novalidate>
            <div id="chat" class="chat" role="log" aria-live="polite"></div>
            <div class="bar">
              <label class="visually-hidden" for="input" data-i18n="messageLabel">Chat message</label>
              <textarea id="input" placeholder="Type a message‚Ä¶" aria-label="Message input"></textarea>
              <button id="micBtn" type="button" class="mic-btn" aria-pressed="false" aria-label="Start voice input" disabled>
                <span aria-hidden="true">üé§</span>
                <span class="visually-hidden">Start voice input</span>
              </button>
              <button id="send" type="submit">Send</button>
            </div>
            <div class="muted" id="status" role="status" aria-live="polite"></div>
            <div class="bad" id="warn" role="alert"></div>
            <div class="session-meters" id="usageMeters" aria-live="polite">
              <div class="session-meter" id="tokenMeter" role="status">
                <span class="muted">Token use</span>
                <progress id="tokenProgress" value="0" max="1" aria-label="Token usage"></progress>
                <span class="session-meter-value" id="tokenValue">0</span>
              </div>
              <div class="session-meter hidden" id="minuteMeter" role="status">
                <span class="muted">Minutes</span>
                <progress id="minuteProgress" value="0" max="1" aria-label="Minute usage"></progress>
                <span class="session-meter-value" id="minuteValue">0</span>
              </div>
            </div>
          </form>
        </div>
      </section>

    </main>

    <footer>
      <nav class="footer-links" aria-label="Compliance policies and legal notices">
        <button type="button" class="footer-link" data-dialog-target="cookieDialog">Cookie Consent</button>
        <button type="button" class="footer-link" data-dialog-target="termsDialog">Terms &amp; Conditions</button>
        <button type="button" class="footer-link" data-dialog-target="rightsDialog">Trademark &amp; Copyright</button>
      </nav>
      <p class="footer-copy" id="footerCopy"></p>
    </footer>
  </div>

  <dialog id="cookieDialog" class="policy-dialog" aria-labelledby="cookieDialogTitle">
    <form method="dialog" class="policy-dialog__content">
      <header>
        <h2 id="cookieDialogTitle">Cookie Consent</h2>
        <button type="submit" class="dialog-close" value="close" aria-label="Close" data-dialog-close>√ó</button>
      </header>
      <p>We only deploy essential cookies required to secure the session, detect abuse, and remember your accessibility preferences. Analytics are aggregated, anonymous, and never include personal identifiers.</p>
      <p>Your chat content remains local-first unless policy escalates it to protected infrastructure. Declining optional cookies keeps the experience functional without personalization.</p>
    </form>
  </dialog>

  <dialog id="termsDialog" class="policy-dialog" aria-labelledby="termsDialogTitle">
    <form method="dialog" class="policy-dialog__content">
      <header>
        <h2 id="termsDialogTitle">Terms &amp; Conditions</h2>
        <button type="submit" class="dialog-close" value="close" aria-label="Close" data-dialog-close>√ó</button>
      </header>
      <p>By engaging with this assistant you agree to follow acceptable use rules, refrain from submitting malicious or regulated data, and respect all confidentiality markings produced by the system.</p>
      <p>Service is provided on an ‚Äúas-is‚Äù basis without warranties. Availability targets follow PCI DSS operational practices and disputes are governed by the applicable laws of your jurisdiction.</p>
    </form>
  </dialog>

  <dialog id="rightsDialog" class="policy-dialog" aria-labelledby="rightsDialogTitle">
    <form method="dialog" class="policy-dialog__content">
      <header>
        <h2 id="rightsDialogTitle">Trademark &amp; Copyright</h2>
        <button type="submit" class="dialog-close" value="close" aria-label="Close" data-dialog-close>√ó</button>
      </header>
      <p>&copy; <span id="copyrightYear"></span> ShieldOps Consortium. All rights reserved. ShieldOps, the Shield insignia, and related marks are protected trademarks.</p>
      <p>Unauthorized reproduction, redistribution, or modification of platform assets is prohibited. Third-party names remain the property of their respective owners and are referenced solely for identification.</p>
    </form>
  </dialog>

<script src="./shield.js" defer></script>
<script src="./app.js" defer></script>
</body>
</html>
