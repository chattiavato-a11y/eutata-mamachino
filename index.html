<!doctype html>
<html lang="en" data-theme="dark">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Chat · Local-first with WebGPU fallback</title>
<style>
  :root{ --bg:#0b0c10; --card:#121319; --ink:#e6e6e6; --muted:#a9b0b8; --accent:#6ad1ff; --ring:rgba(106,209,255,.35); }
  [data-theme="light"]{ --bg:#ffffff; --card:#f5f7fb; --ink:#1f2430; --muted:#536070; --accent:#0077ff; --ring:rgba(0,119,255,.25); }
  body{margin:0;background:var(--bg);color:var(--ink);font:14px/1.5 system-ui,Segoe UI,Roboto,Helvetica,Arial;}
  .wrap{max-width:900px;margin:0 auto;padding:20px}
  header{display:flex;gap:10px;align-items:center;justify-content:space-between;margin-bottom:10px;flex-wrap:wrap}
  .toggles{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  button,select{background:var(--card);color:var(--ink);border:1px solid #242634;border-radius:10px;padding:8px 12px}
  button:hover{outline:2px solid var(--ring)}
  .session-meters{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:8px}
  .session-meter{display:inline-flex;align-items:center;gap:8px;padding:6px 12px;border-radius:999px;border:1px solid #242634;background:var(--card);font-size:12px}
  .session-meter progress{width:120px;height:6px;border-radius:999px;overflow:hidden;background:rgba(255,255,255,.08)}
  .session-meter progress::-webkit-progress-bar{background:rgba(255,255,255,.08);border-radius:999px}
  .session-meter progress::-webkit-progress-value{background:var(--accent);border-radius:999px}
  .session-meter progress::-moz-progress-bar{background:var(--accent);border-radius:999px}
  .session-meter-value{font-variant-numeric:tabular-nums;color:var(--ink)}
  .chat{background:var(--card);border:1px solid #242634;border-radius:14px;padding:14px;height:60vh;overflow:auto}
  .msg{margin:8px 0;padding:10px 12px;border-radius:10px;white-space:pre-wrap}
  .me{background:rgba(106,209,255,.08);border:1px solid rgba(106,209,255,.25)}
  .ai{background:rgba(255,255,255,.03);border:1px solid #2a2d3b}
  .bar{display:flex;gap:8px;margin-top:10px}
  .bar textarea{flex:1;min-height:44px;max-height:160px;resize:vertical;background:var(--card);color:var(--ink);border:1px solid #242634;border-radius:10px;padding:10px}
  .muted{color:var(--muted);font-size:12px}
  .bad{color:#ff7b7b}
</style>

<body>
  <div class="wrap">
    <header>
      <div>
        <h1>OPS Chat Interface</h1>
      </div>
      <div class="toggles" role="group" aria-label="Display and language settings">
        <label for="themeBtn" class="muted">Theme</label>
        <button id="themeBtn" type="button" aria-pressed="true">Dark</button>
        <label for="langSel" class="muted">Lang</label>
        <select id="langSel" aria-label="Language selector">
          <option value="en" selected>EN</option>
          <option value="es">ES</option>
        </select>
      </div>
    </header>

    <main>
      <section aria-labelledby="chat-title">
        <div class="policy-card">
          <h2 id="chat-title">Session Console</h2>
          <form id="chatForm" novalidate>
            <div id="chat" class="chat" role="log" aria-live="polite"></div>
            <div class="bar">
              <label class="visually-hidden" for="input">Chat message</label>
              <textarea id="input" placeholder="Type a message…" aria-label="Message input"></textarea>
              <button id="send" type="submit">Send</button>
            </div>
            <div class="muted" id="status" role="status" aria-live="polite"></div>
            <div class="bad" id="warn" role="alert"></div>
            <div class="session-meters" id="usageMeters" aria-live="polite">
              <div class="session-meter" id="tokenMeter" role="status">
                <span class="muted">Token use</span>
                <progress id="tokenProgress" value="0" max="1" aria-label="Token usage"></progress>
                <span class="session-meter-value" id="tokenValue">0</span>
              </div>
              <div class="session-meter hidden" id="minuteMeter" role="status">
                <span class="muted">Minutes</span>
                <progress id="minuteProgress" value="0" max="1" aria-label="Minute usage"></progress>
                <span class="session-meter-value" id="minuteValue">0</span>
              </div>
            </div>
          </form>
        </div>
      </section>

    </main>

    <footer>
      <nav class="footer-links" aria-label="Compliance policies">
        <details>
          <summary>Cookie Consent</summary>
          <p>By using this tool, you agree that essential cookies collect operational details needed for the service. We study aggregated chatbot interaction behavior strictly to improve responses, and no PII or other data beyond chat content is gathered.</p>
        </details>
        <details>
          <summary>Terms &amp; Conditions</summary>
          <p>Use of this chat interface signifies agreement to comply with all acceptable use policies, maintain confidentiality of outputs, and avoid transmitting malicious or unauthorized data.</p>
          <p>Services are provided “as is” with no warranty; uptime targets follow PCI DSS operational resilience guidelines, and jurisdiction is governed by applicable local laws.</p>
        </details>
        <details>
          <summary>Trademark &amp; Copyright</summary>
          <p>&copy; <span id="copyrightYear"></span> Operations Desk. All rights reserved. All names and marks referenced remain the property of their respective owners.</p>
          <p>Unauthorized reproduction, distribution, or modification is prohibited without prior written consent. Third-party marks referenced are property of their owners.</p>
        </details>
      </nav>
    </footer>
  </div>

  <div id="cookieBanner" class="cookie-banner hidden" role="dialog" aria-live="polite" aria-modal="false" aria-label="Cookie consent">
    <div>
      <strong>Session routing guidance</strong><br>
      <span class="muted">Local-first unless escalation is approved. Session budget: 75k–100k tokens.</span>
    </div>
    <div class="toggles">
      <button id="themeBtn" aria-pressed="true">Dark</button>
      <label class="muted">Lang</label>
      <select id="langSel"><option value="en" selected>EN</option><option value="es">ES</option></select>
    </div>
    <div class="cookie-actions">
      <button id="declineCookies" type="button">Remind me later</button>
      <button id="acceptCookies" type="button">Agree &amp; continue</button>
    </div>
    <div class="muted" id="cookieStatus"></div>
    <div class="bad" id="cookieWarn"></div>
  </div>

<script src="./shield.js" defer></script>
<script src="./app.js" defer></script>
</body>
</html>
